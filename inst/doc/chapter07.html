<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Blocking and Confounding in the 2k Factorial Design</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Blocking and Confounding in the 2<sup>k</sup> Factorial Design</h1>



<div id="example-7.1" class="section level1">
<h1>Example 7.1</h1>
<p>The example uses the data from Figure 6.1 of Section 6.2. Recall that the experimenter seeks to optimize yield by varying reactant concentration (<code>A</code>) and catalyst amount (<code>B</code>), but this time we’ll run the experiment in three blocks as shown in Table 7.1. First, we model the blocks as fixed effects.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">df &lt;-<span class="st"> </span>Figure6<span class="fl">.1</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">df[,<span class="st">'Block'</span>] &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">model &lt;-<span class="st"> </span><span class="kw">aov</span>(Yield <span class="op">~</span><span class="st"> </span><span class="kw">Error</span>(Block) <span class="op">+</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B, <span class="dt">data=</span>df)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">summary</span>(model)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Error: Block</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># Residuals  2    6.5    3.25               </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># Error: Within</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># A          1 208.33  208.33  50.336 0.000394 ***</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># B          1  75.00   75.00  18.121 0.005340 ** </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># A:B        1   8.33    8.33   2.013 0.205710    </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># Residuals  6  24.83    4.14                     </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># ---</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a></code></pre></div>
<p>Next, we model the blocks as random effects.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(lme4)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(lmerTest)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">model &lt;-<span class="st"> </span><span class="kw">lmer</span>(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    Yield <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Block),</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="dt">data=</span>df,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="dt">REML=</span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">summary</span>(model)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># lmerModLmerTest]</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># Formula: Yield ~ A * B + (1 | Block)</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#    Data: df</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co"># REML criterion at convergence: 43.6</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># Scaled residuals: </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co"># -1.0106 -0.6737 -0.2526  0.5474  1.5159 </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co"># </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># Random effects:</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#  Groups   Name        Variance Std.Dev.</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#  Block    (Intercept) 0.000    0.000   </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#  Residual             3.917    1.979   </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co"># Number of obs: 12, groups:  Block, 3</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co"># </span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co"># Fixed effects:</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#             Estimate Std. Error      df t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co"># (Intercept)  27.5000     0.5713  8.0000  48.135 3.84e-11 ***</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co"># A             4.1667     0.5713  8.0000   7.293 8.44e-05 ***</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co"># B            -2.5000     0.5713  8.0000  -4.376  0.00236 ** </span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co"># A:B           0.8333     0.5713  8.0000   1.459  0.18278    </span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co"># ---</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co"># </span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co"># Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#     (Intr) A     B    </span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co"># A   0.000             </span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co"># B   0.000  0.000      </span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co"># A:B 0.000  0.000 0.000</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co"># convergence code: 0</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co"># boundary (singular) fit: see ?isSingular</span></a></code></pre></div>
<p>The blocking failed to show significance in the likelihood ratio test, shown next.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">rand</span>(model)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># ANOVA-like table for random-effects: Single term deletions</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># Model:</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># Yield ~ A + B + (1 | Block) + A:B</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#             npar  logLik    AIC        LRT Df Pr(&gt;Chisq)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># &lt;none&gt;         6 -21.782 55.565                         </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># (1 | Block)    5 -21.782 53.565 1.4211e-14  1          1</span></a></code></pre></div>
<p>Finally, we present confidence intervals for the main effects and for the variance components.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">confint</span>(model, <span class="dt">oldNames=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># Warning in nextpar(mat, cc, i, delta, lowcut, upcut): Last two rows have</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># identical or NA .zeta values: using minstep</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># Warning in nextpar(mat, cc, i, delta, lowcut, upcut): Last two rows have</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># identical or NA .zeta values: using minstep</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Warning in FUN(X[[i]], ...): non-monotonic profile for sd_(Intercept)|Block</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># Warning in confint.thpr(pp, level = level, zeta = zeta): bad spline fit for</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co"># sd_(Intercept)|Block: falling back to linear interpolation</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># Warning in regularize.values(x, y, ties, missing(ties)): collapsing to</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co"># unique 'x' values</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#                           2.5 %    97.5 %</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co"># sd_(Intercept)|Block  0.0000000  2.055783</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co"># sigma                 1.1351296  2.563095</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co"># (Intercept)          26.5074479 28.492552</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co"># A                     3.1741146  5.159219</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co"># B                    -3.4925521 -1.507448</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co"># A:B                  -0.1592188  1.825885</span></a></code></pre></div>
<hr />
</div>
<div id="example-7.2" class="section level1">
<h1>Example 7.2</h1>
<p>We revisit the experiment from Example 6.2 where we are changing temperature, pressure, concentration of formaldehyde, and stirring rate to determine the effect on the filtration rate. Now we’re going to use the highest order interaction term as a blocking scheme. First we run the full model looking for the largest effects.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">df &lt;-<span class="st"> </span>Table6<span class="fl">.10</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">df[df<span class="op">$</span>Block <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">'Filtration'</span>] &lt;-<span class="st"> </span>df[df<span class="op">$</span>Block <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">'Filtration'</span>] <span class="op">-</span><span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">model &lt;-<span class="st"> </span><span class="kw">aov</span>(Filtration <span class="op">~</span><span class="st"> </span>Temperature <span class="op">*</span><span class="st"> </span>Pressure <span class="op">*</span><span class="st"> </span>Formaldehyde <span class="op">*</span><span class="st"> </span>StirringRate, <span class="dt">data=</span>Table6<span class="fl">.10</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">model.ss &lt;-<span class="st"> </span><span class="kw">anova</span>(model)[[<span class="st">'Sum Sq'</span>]]</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># Warning in anova.lm(model): ANOVA F-tests on an essentially perfect fit are</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># unreliable</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">effect.estimates &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">    <span class="st">'EffectEstimate'</span>=<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">coef</span>(model)[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="st">'SumOfSquares'</span>=model.ss[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">    <span class="st">'Contribution'</span>=<span class="kw">sprintf</span>(<span class="st">'%0.2f%%'</span>, <span class="dv">100</span><span class="op">*</span>model.ss[<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(model.ss[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">)</a></code></pre></div>
<table class="table" style="font-size: 10px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
EffectEstimate
</th>
<th style="text-align:right;">
SumOfSquares
</th>
<th style="text-align:left;">
Contribution
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Temperature
</td>
<td style="text-align:right;">
21.625
</td>
<td style="text-align:right;">
39.0625
</td>
<td style="text-align:left;">
1.01%
</td>
</tr>
<tr>
<td style="text-align:left;">
Pressure
</td>
<td style="text-align:right;">
3.125
</td>
<td style="text-align:right;">
390.0625
</td>
<td style="text-align:left;">
10.10%
</td>
</tr>
<tr>
<td style="text-align:left;">
Formaldehyde
</td>
<td style="text-align:right;">
9.875
</td>
<td style="text-align:right;">
855.5625
</td>
<td style="text-align:left;">
22.16%
</td>
</tr>
<tr>
<td style="text-align:left;">
StirringRate
</td>
<td style="text-align:right;">
14.625
</td>
<td style="text-align:right;">
0.0625
</td>
<td style="text-align:left;">
0.00%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Pressure
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:right;">
1314.0625
</td>
<td style="text-align:left;">
34.04%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Formaldehyde
</td>
<td style="text-align:right;">
-18.125
</td>
<td style="text-align:right;">
22.5625
</td>
<td style="text-align:left;">
0.58%
</td>
</tr>
<tr>
<td style="text-align:left;">
Pressure:Formaldehyde
</td>
<td style="text-align:right;">
2.375
</td>
<td style="text-align:right;">
1105.5625
</td>
<td style="text-align:left;">
28.64%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:StirringRate
</td>
<td style="text-align:right;">
16.625
</td>
<td style="text-align:right;">
0.5625
</td>
<td style="text-align:left;">
0.01%
</td>
</tr>
<tr>
<td style="text-align:left;">
Pressure:StirringRate
</td>
<td style="text-align:right;">
-0.375
</td>
<td style="text-align:right;">
5.0625
</td>
<td style="text-align:left;">
0.13%
</td>
</tr>
<tr>
<td style="text-align:left;">
Formaldehyde:StirringRate
</td>
<td style="text-align:right;">
-1.125
</td>
<td style="text-align:right;">
14.0625
</td>
<td style="text-align:left;">
0.36%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Pressure:Formaldehyde
</td>
<td style="text-align:right;">
1.875
</td>
<td style="text-align:right;">
68.0625
</td>
<td style="text-align:left;">
1.76%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Pressure:StirringRate
</td>
<td style="text-align:right;">
4.125
</td>
<td style="text-align:right;">
10.5625
</td>
<td style="text-align:left;">
0.27%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Formaldehyde:StirringRate
</td>
<td style="text-align:right;">
-1.625
</td>
<td style="text-align:right;">
27.5625
</td>
<td style="text-align:left;">
0.71%
</td>
</tr>
<tr>
<td style="text-align:left;">
Pressure:Formaldehyde:StirringRate
</td>
<td style="text-align:right;">
-2.625
</td>
<td style="text-align:right;">
7.5625
</td>
<td style="text-align:left;">
0.20%
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature:Pressure:Formaldehyde:StirringRate
</td>
<td style="text-align:right;">
1.375
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:left;">
0.00%
</td>
</tr>
</tbody>
</table>
<p>Next, we choose the largest effects and proceed with that reduced model while marking our <code>Block</code> as an error term.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">aov</span>(Filtration <span class="op">~</span><span class="st"> </span><span class="kw">Error</span>(Block) <span class="op">+</span><span class="st"> </span>Temperature <span class="op">+</span><span class="st"> </span>Formaldehyde <span class="op">+</span><span class="st"> </span>StirringRate <span class="op">+</span><span class="st"> </span>Temperature<span class="op">:</span>Formaldehyde <span class="op">+</span><span class="st"> </span>Temperature<span class="op">:</span>StirringRate, <span class="dt">data=</span>df)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">summary</span>(model)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Error: Block</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co"># Residuals  1   1388    1388               </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co"># Error: Within</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#                          Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># Temperature               1 1870.6  1870.6   89.76 5.60e-06 ***</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co"># Formaldehyde              1  390.1   390.1   18.72 0.001915 ** </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co"># StirringRate              1  855.6   855.6   41.05 0.000124 ***</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># Temperature:Formaldehyde  1 1314.1  1314.1   63.05 2.35e-05 ***</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co"># Temperature:StirringRate  1 1105.6  1105.6   53.05 4.65e-05 ***</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co"># Residuals                 9  187.6    20.8                     </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co"># ---</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a></code></pre></div>
<hr />
</div>
<div id="example-7.3" class="section level1">
<h1>Example 7.3</h1>
<p>We return to the plasma etching experiment of Example 6.1. This time we’re adding blocking! Note that I’ve added a <code>Block</code> for convenience, but in the R output we see it noticed we were aliasing <code>Gap:Flow</code> and <code>Gap:Flow:Power</code> interactions with blocks.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">aov</span>(EtchRate <span class="op">~</span><span class="st"> </span><span class="kw">Error</span>(Block) <span class="op">+</span><span class="st"> </span>Gap <span class="op">*</span><span class="st"> </span>Flow <span class="op">*</span><span class="st"> </span>Power, <span class="dt">data=</span>Table6<span class="fl">.4</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">summary</span>(model)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Error: Block</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#                Df Sum Sq Mean Sq</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># Power           1 374850  374850</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co"># Gap:Flow        1   2475    2475</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co"># Gap:Flow:Power  1    127     127</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># Error: Within</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#            Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co"># Gap         1  41311   41311  18.339 0.002679 ** </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># Flow        1    218     218   0.097 0.763911    </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co"># Gap:Power   1  94403   94403  41.909 0.000193 ***</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># Flow:Power  1     18      18   0.008 0.930849    </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co"># Residuals   8  18020    2253                     </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co"># ---</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
